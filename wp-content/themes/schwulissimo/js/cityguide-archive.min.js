jQuery(document).ready(function(a){function b(a){var b=new google.maps.Geocoder;b.geocode({address:a,region:"de"},function(a,b){b==google.maps.GeocoderStatus.OK&&(map.setCenter(a[0].geometry.location),map.setZoom(12))})}var markers=a.parseJSON(post_info.needles),c={};a("#cityguide-where").change(function(){b(a(this).val())}),a("#cityguide-where").autocomplete({source:function(b,c){a.post(ajaxurl,{action:"search_cityguide_where",data:b.term},function(b){return c(a.parseJSON(b)),a.extend({label:item.label||item.value,value:item.value||item.label},item)})},minLength:2,select:function(a,c){b(c.item.value)},appendTo:"#cityguide-where-container"}),a("#cityguide-what").autocomplete({source:function(b,c){a.post(ajaxurl,{action:"search_cityguide_what",data:b.term,ort:a("#cityguide-where").val()},function(b){c(a.parseJSON(b))})},minLength:3,select:function(b,d){return a.each(c,function(a,b){this.setAnimation(null)}),isNaN(d.item.value)?a.post(ajaxurl,{action:"get_tax_bounces",data:d.item.value},function(b){bounce=a.parseJSON(b),a.each(c,function(a,b){b.setMap(null)}),a(bounce).each(function(a,b){try{c[b].setMap(map),map.setZoom(13)}catch(a){}})}):(a.each(c,function(a,b){b.setMap(map)}),c[d.item.value].setAnimation(google.maps.Animation.BOUNCE),latlng=c[d.item.value].getPosition(),map.setCenter(latlng),map.setZoom(16)),a("#cityguide-what").val(d.item.label),a("#cityguide-what-id").val(d.item.value),this.value=d.item.label,!1},appendTo:"#cityguide-what-container",delay:200}),map=new google.maps.Map(document.getElementById("cityguide-archive-map"),{center:{lat:51,lng:9},zoom:5});var d,e,f=new google.maps.InfoWindow,g={url:post_info.markerIcon};for(e=0;e<markers.length;e++)d=new google.maps.Marker({position:{lat:parseFloat(markers[e].lat),lng:parseFloat(markers[e].lng)},map:map,icon:g}),c[markers[e].post_id]=d,google.maps.event.addListener(d,"click",function(b,c){return function(){f.setContent('<img src="'+post_info.spinner+'">'),f.open(map,b),a.post(ajaxurl,{data:markers[c].post_id,action:"get_map_infobox"},function(a){f.setContent(a)})}}(d,e))});